version: 2.1

docker-def: &docker-def
    docker:
      - image: amazon/aws-cli

jobs:
  create_infrastructure:
    <<: *docker-def
    steps:
      checkout
      - run: aws cloudformation create-stack --stack-name ansible-ec2  --template-body file://../template.yml --capabilities "CAPABILITY_IAM" "CAPABILITY_NAMED_IAM" --region=us-west-2


workflows:
  wf-create-infra:
    jobs: 
      - create_infrastructure
